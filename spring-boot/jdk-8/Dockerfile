FROM andreptb/oracle-java:8-alpine

LABEL MAINTAINER="Andr√© Justi <justi.andre@gmail.com>"

WORKDIR /data/

ONBUILD ARG PROFILES
ONBUILD ARG PORT
ONBUILD ARG SPRING_PROFILES_ACTIVE
ONBUILD ARG JAVA_OPTS
ONBUILD ARG SERVER_PORT
ONBUILD ARG PATH_JAR

ONBUILD ENV SPRING_PROFILES_ACTIVE ${SPRING_PROFILES_ACTIVE:-${PROFILES:-default}}
ONBUILD ENV JAVA_OPTS ${JAVA_OPTS:-'-Xmx512m'}
ONBUILD ENV SERVER_PORT ${SERVER_PORT:-${PORT:-9999}}
ONBUILD ENV PATH_JAR ${PATH_JAR:-./target/}

ONBUILD ADD ${PATH_JAR}*.jar app.jar

RUN apk update && apk add --no-cache bash

ONBUILD EXPOSE ${SERVER_PORT}

CMD java ${JAVA_OPTS} -Djava.security.egd=file:/dev/./urandom -jar app.jar
